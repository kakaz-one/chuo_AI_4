# 第3回 関数の基礎 - 学習ノート

## はじめに
このノートは、プログラミング初心者の方が「関数」について理解できるように、丁寧にまとめたものです。

---

## 目次
1. 関数とは
2. 引数と戻り値
3. 関数を使用する利点
4. モジュール
5. 関数の定義方法
6. メソッド
7. 参考：関数の定義応用編

---

## 1. 関数とは

### 関数の基本概念

**関数とは、入力に対して出力を返す仕組みです。**

- 英語では「function（機能）」といいます
- 頻繁に実行する処理をまとめて、いつでも使えるようにする仕組みです
- 自分で関数を作ることもできます（これを「関数を定義する」といいます）

### 関数のイメージ図

```
入力（引数）     →     【関数】     →     出力（戻り値）
   arg                  ⚙️                 return
```

### 関数の3つの要素

1. **入力（引数）** - 関数に渡すデータ
2. **処理** - 関数が実行する計算や操作
3. **出力（戻り値）** - 関数が返す結果

**重要なポイント：**
- 引数と戻り値は必須ではありません
- 引数がない関数もあります
- 戻り値がない関数もあります（例：`print()`）

---

## 2. 引数と戻り値

### 引数（ひきすう）とは

**引数（argument）** は、関数を呼び出すときに渡すデータのことです。

```python
# 例：int()関数に文字列'5'を渡す
result = int('5')
```

- 引数は `()` の中に入れます
- どんなデータを、いくつ渡すかは関数によって決まっています
- 引数が不要な関数もあります

### 戻り値（もどりち）とは

**戻り値（return）** は、関数が処理した結果として出力するデータのことです。

```python
# int('5')の場合
入力：'5'（文字列）
処理：文字列を整数に変換
出力：5（整数）
```

- どんなデータが返ってくるかは関数ごとに決まっています
- 戻り値がない関数もあります（例：`print()`関数）

### 具体例：int()関数

```
'5'（文字列） → 【int()関数】 → 5（整数）
```

この関数は、文字列で表された数字を、実際の数値（整数）に変換します。

---

## 3. 関数を使用する利点

### 比較：関数を使わない場合 vs 使う場合

**例題：リストの要素の合計値を計算する**

#### ❌ 関数を使わない場合

```python
sample_list = [2, 5, 102, 34, 9]
total = 0
for item in sample_list:
    total = total + item
print(total)
```

**問題点：**
- コードが長くて複雑
- 合計を計算するたびに同じコードを書く必要がある
- 手で書くため、間違える可能性がある

#### ✅ 組み込み関数を使う場合

```python
sample_list = [2, 5, 102, 34, 9]
total = sum(sample_list)
print(total)
```

**利点：**
- コードが短くてわかりやすい
- 一度正しく動く関数を作れば、何度使っても安全
- 読みやすく、間違いが少ない

### 関数を使う3つのメリット

1. **可読性が高い** - コードが読みやすくなる
2. **ミスが少ない** - テスト済みの関数を使うので安全
3. **再利用できる** - 同じ処理を何度でも使える

---

## 4. モジュール

### モジュールとは

**モジュール** は、複数の関数などの機能をまとめたものです。

```
モジュール = 関数の詰め合わせパック
```

### モジュールの集合 = ライブラリ

モジュールをさらにまとめたものを**ライブラリ**と呼びます。

#### ライブラリの種類

1. **標準ライブラリ**
   - Pythonに最初から付属している
   - インストール不要ですぐに使える
   - 例：`math`、`statistics`、`pickle`など

2. **外部ライブラリ**
   - 別途インストールが必要
   - `pip`や`conda`を使ってインストールする
   - 例：`matplotlib`、`pandas`、`numpy`など

### モジュールのインポート方法

モジュールを使うには、`import`文でインポート（読み込み）する必要があります。

#### 基本的なインポート

```python
import モジュール名
```

**使用例：**
```python
import statistics
li = [1, 5, 11, 13, 21]
statistics.median(li)  # 中央値を計算
statistics.mean(li)    # 平均値を計算
```

実行結果：
```
11      # 中央値
10.2    # 平均値
```

#### asを使ったインポート（別名をつける）

```python
import モジュール名 as 別名
```

**よく使われる慣習的な別名：**
```python
import numpy as np      # numpyをnpという名前で使う
import pandas as pd     # pandasをpdという名前で使う
```

#### fromを使ったインポート（特定の関数だけ）

```python
from モジュール名 import 関数名
```

**使用例：**
```python
from statistics import median, mean

li = [1, 5, 11, 13, 21]
median(li)  # モジュール名を書かなくてOK
mean(li)
```

実行結果：
```
11      # 中央値
10.2    # 平均値
```

### 標準ライブラリの例：mathモジュール

mathモジュールには数学関数がたくさん入っています。

```python
import math
```

**主な関数と定数：**

| 種類 | コード | 内容 |
|------|--------|------|
| 定数 | `math.pi` | 円周率（3.14159...） |
| 定数 | `math.e` | 自然対数の底（2.71828...） |
| 関数 | `math.sqrt()` | 平方根（ルート） |
| 関数 | `math.exp()` | 指数関数 |
| 関数 | `math.log()` | 自然対数 |
| 関数 | `math.sin()` | 正弦（サイン） |
| 関数 | `math.cos()` | 余弦（コサイン） |
| 関数 | `math.ceil()` | 小数の切り上げ |
| 関数 | `math.floor()` | 小数の切り捨て |

---

## 5. 関数の定義方法

### 関数を自分で作る

関数は自分で作ることができます。これを「関数を定義する」といいます。

### 関数の書き方

```python
def 関数名(仮引数1, 仮引数2, ...):
    処理内容
    return 戻り値
```

**重要なルール：**
- `def`キーワードで始める
- 関数名の後に`()`をつける
- 行の最後に`:`（コロン）をつける
- 処理内容は**インデント**（4つの半角スペース）を入れる
- `return`で戻り値を指定する

### 具体例：数値を2倍にする関数

```python
def mul(arg):
    result = arg * 2
    return result

# 関数を呼び出す
mul(5)
```

実行結果：
```
10
```

**解説：**
1. `mul`という名前の関数を定義
2. 引数`arg`を受け取る
3. `arg`を2倍して`result`に代入
4. `result`を戻り値として返す

### デフォルト引数

引数に初期値を設定できます。引数が省略された場合、この初期値が使われます。

```python
def func_default(arg_1, arg_2=2):
    result = arg_1 * arg_2
    return result

# 使い方
func_default(5)      # arg_2は省略されるので2が使われる
func_default(5, 3)   # arg_2に3を指定
```

実行結果：
```
10   # 5 × 2
15   # 5 × 3
```

### キーワード引数

引数を名前で指定して渡すことができます。

```python
def func_default(arg_1, arg_2=2):
    result = arg_1 * arg_2
    return result

# キーワード引数を使用
func_default(arg_1=4, arg_2=3)
```

実行結果：
```
12
```

**キーワード引数の利点：**
- 引数の順序を入れ替えてもOK
- コードが読みやすくなる
- 引数の意味が明確になる

**順序を入れ替えた例：**
```python
func_default(arg_2=3, arg_1=4)  # これでもOK
```

実行結果：
```
12
```

**重要な注意点：**

位置引数よりも前にキーワード引数を書くとエラーになります。

```python
# ❌ エラーになる例
func_default(arg_2=3, 4)  # キーワード引数の後に位置引数はNG
```

### 位置引数とキーワード引数

- **位置引数**：順番で引数を渡す方法
- **キーワード引数**：名前で引数を渡す方法

```python
# 位置引数
func_default(4, 3)

# キーワード引数
func_default(arg_1=4, arg_2=3)

# 混在（位置引数が先）
func_default(4, arg_2=3)  # ✅ OK
```

### 練習問題

以下の条件を満たす関数を定義してください。

**条件：**
- 関数名：`calc_summary_statistics`
- 引数：数値のリスト
- 戻り値：タプル（合計値、平均値、最小値、最大値）

**使用例：**
```python
calc_summary_statistics([1, 2, 3, 4, 5])
```

**期待される実行結果：**
```
(15, 3.0, 1, 5)
```

---

## 6. メソッド

### メソッドとは

**メソッド（method）** は、データ型に紐づいた特別な関数です。

### 関数とメソッドの違い

#### 関数の書き方
```python
関数名(データ, 引数)
```

例：
```python
len([1, 2, 3])         # リストの長さを取得
sum([1, 2, 3])         # リストの合計を計算
```

#### メソッドの書き方
```python
データ.メソッド名(引数)
```

例：
```python
[1, 2, 3].append(4)    # リストに要素を追加
'hello'.upper()        # 文字列を大文字に変換
```

### メソッドの具体例

#### リストのappendメソッド

```python
cubes = [1, 8, 27, 64, 125]
cubes.append(6**3)  # 216を追加
print(cubes)
```

実行結果：
```
[1, 8, 27, 64, 125, 216]
```

### よく使うメソッド一覧

#### 文字列のメソッド

| メソッド | 処理内容 | 使用例 | 実行結果 |
|----------|----------|--------|----------|
| `lower()` | 小文字に変換 | `'TOKYO'.lower()` | `'tokyo'` |
| `upper()` | 大文字に変換 | `'tokyo'.upper()` | `'TOKYO'` |
| `split()` | 文字列を分割 | `'I love python'.split(' ')` | `['I', 'love', 'python']` |
| `replace()` | 文字列を置換 | `'I love SQL'.replace('SQL', 'R')` | `'I love R'` |
| `join()` | 文字列を連結 | `'-'.join('python')` | `'p-y-t-h-o-n'` |

#### リストのメソッド

| メソッド | 処理内容 | 使用例 | 実行結果 |
|----------|----------|--------|----------|
| `append()` | 末尾に要素を追加 | `[1, 2, 3].append(4)` | `[1, 2, 3, 4]` |
| `remove()` | 要素を削除 | `[1, 10, 100].remove(10)` | `[1, 100]` |
| `sort()` | 並び替え | `[5, 3, 6].sort()` | `[3, 5, 6]` |
| `count()` | 要素の個数を数える | `[1, 10, 50, 10].count(10)` | `2` |
| `index()` | 要素の位置を取得 | `[1, 10, 100].index(100)` | `2` |

#### 共通で使えるメソッド

| メソッド | 文字列 | リスト | タプル | 使用例 | 実行結果 |
|----------|--------|--------|--------|--------|----------|
| `index()` | ○ | ○ | ○ | `'python'.index('p')` | `0` |
| `count()` | ○ | ○ | ○ | `[1, 10, 50, 10].count(10)` | `2` |

### 関数とメソッドの使い分け

Pythonでは、関数とメソッドを組み合わせて使います。

```python
cubes = [1, 8, 27, 64, 125]

# 関数の例
len(cubes)                      # リストの長さ
sum(cubes)                      # リストの合計
sorted(cubes, reverse=True)     # リストを降順にソート

# メソッドの例
cubes.append(216)               # リストに要素を追加
cubes.remove(8)                 # リストから要素を削除
cubes.index(27)                 # 要素の位置を取得
```

---

## 7. 参考：関数の定義応用編

### ラムダ式（無名関数）

**ラムダ式** は、名前のない小さな使い捨ての関数です。

#### ラムダ式の書き方

```python
lambda 引数: 戻り値
```

#### def文との比較

**def文を使った定義：**
```python
def func(a):
    return a * 2

func(2)  # 実行結果：4
```

**ラムダ式を使った定義：**
```python
lambda_sample = lambda a: a * 2
lambda_sample(2)  # 実行結果：4
```

**注意：** Pythonのコーディング規約（PEP8）では、ラムダ式を変数に代入するのは非推奨です。

#### 複数の引数を持つラムダ式

```python
# 直方体の体積を求める
volume = lambda width, depth, height: width * depth * height
volume(10, 4, 5)  # 実行結果：200
```

#### ラムダ式の活用例：sorted()関数

```python
li = ['cat', 'bear', 'albert']

# 通常のソート（1文字目でソート）
sorted(li)
# 実行結果：['albert', 'bear', 'cat']

# ラムダ式で2文字目でソート
sorted(li, key=lambda x: x[1])
# 実行結果：['cat', 'bear', 'albert']
```

**解説：**
- `sorted()`関数の`key`引数に関数を指定すると、その関数の結果でソートされます
- ラムダ式を使うと、簡潔に条件を指定できます

### 可変長引数（*args）

任意の数の引数を受け取ることができます。

```python
def func_sum(a, *args):
    x = a + sum(args)
    return x

func_sum(10, 1, 2)           # 実行結果：13
func_sum(10, 1, 2, 3, 4, 5)  # 実行結果：25
```

**解説：**
- `*args`は、最初の引数以外のすべての引数をタプルとして受け取ります
- `*`の後の名前は`args`でなくても構いません（例：`*items`）

### 可変長キーワード引数（**kwargs）

任意の数のキーワード引数を受け取ることができます。

```python
def func_kwargs(**kwargs):
    return kwargs

func_kwargs(a=1, b=2)        # 実行結果：{'a': 1, 'b': 2}
func_kwargs(a=1, b=2, c=3)   # 実行結果：{'a': 1, 'b': 2, 'c': 3}
```

**解説：**
- `**kwargs`は、すべてのキーワード引数をディクショナリとして受け取ります
- `**`の後の名前は`kwargs`でなくても構いません（例：`**items`）

### 実引数のアンパッキング

#### *演算子（リスト・タプルの展開）

```python
def func_sum(a, *args):
    x = a + sum(args)
    return x

# 通常の呼び出し
func_sum(10, 1, 2, 3)  # 実行結果：16

# アンパッキングを使った呼び出し
nums = (1, 2, 3)
func_sum(10, *nums)    # 実行結果：16
```

#### **演算子（ディクショナリの展開）

```python
def func_kwargs(**kwargs):
    return kwargs

# 通常の呼び出し
func_kwargs(a=1, b=2, c=3)
# 実行結果：{'a': 1, 'b': 2, 'c': 3}

# アンパッキングを使った呼び出し
my_dict = {'a': 1, 'b': 2, 'c': 3}
func_kwargs(**my_dict)
# 実行結果：{'a': 1, 'b': 2, 'c': 3}
```

### グローバル変数とローカル変数

#### スコープとは

**スコープ** は、変数が有効な範囲のことです。

- **グローバル変数**：プログラム全体で使える変数
- **ローカル変数**：関数の中だけで使える変数

```python
var = 'global variable'  # グローバル変数

def func():
    var = 'local variable'  # ローカル変数
    print(var)

func()        # 実行結果：local variable
print(var)    # 実行結果：global variable
```

**重要なポイント：**
- 関数の中で定義した変数は、関数の外からは見えません
- できる限りローカル変数を使うと、コードが理解しやすくなります
- `if`文や`for`文では新しいスコープは作られません

### モジュールの作成

自分で作った関数をモジュールとして保存できます。

#### モジュールの作成方法

1. `.py`拡張子のファイルを作成
2. ファイル内に関数を定義

**sample.py の内容：**
```python
def add(a, b):
    return a + b

def sub(a, b):
    return a - b
```

#### 作成したモジュールの使い方

```python
import sample

sample.add(3, 2)  # 実行結果：5
sample.sub(3, 2)  # 実行結果：1
```

**注意：** `sample.py`は、使用するファイルと同じフォルダに保存する必要があります。

---

## まとめ

### 重要ポイント

1. **関数とは**
   - 入力（引数）を受け取り、出力（戻り値）を返す仕組み
   - コードの再利用性と可読性を高める

2. **関数の定義**
   - `def`キーワードを使って定義
   - インデント（4つの半角スペース）が重要

3. **モジュール**
   - 関数をまとめたもの
   - `import`文で読み込む

4. **メソッド**
   - データ型に紐づいた関数
   - `データ.メソッド名()`の形で使う

5. **引数の種類**
   - 位置引数：順番で渡す
   - キーワード引数：名前で渡す
   - デフォルト引数：初期値を設定

### 次のステップ

この資料で学んだ内容を使って、実際にプログラムを書いてみましょう！

- 簡単な関数を自分で定義してみる
- 標準ライブラリのモジュールを使ってみる
- メソッドを使ってデータを操作してみる

---

## 章末問題

以下のコードの出力結果を10にする際に、□に入る数値を答えなさい。

```python
import statistics

data = [9, 4, 8, 16, 17, 11, □, 3, 3, 15, 3, 18, 17]
statistics.mean(data)
```

**ヒント：** `mean()`関数は平均値を計算する関数です。

---

### 章末問題の解説

#### ステップ1：問題の理解

この問題では、`statistics.mean()`関数を使ってリストの平均値を計算します。
- 平均値が10になるようにしたい
- リストには□（未知の数）が1つ含まれている

#### ステップ2：平均値の計算方法

平均値は以下の式で計算されます：

```
平均値 = 合計値 ÷ 要素の個数
```

この問題では：
```
10 = 合計値 ÷ 要素の個数
```

#### ステップ3：リストの情報を整理

まず、□以外の数値を確認しましょう。

```python
data = [9, 4, 8, 16, 17, 11, □, 3, 3, 15, 3, 18, 17]
```

**要素の個数：** 13個

**□以外の数値の合計：**
```
9 + 4 + 8 + 16 + 17 + 11 + 3 + 3 + 15 + 3 + 18 + 17 = 124
```

#### ステップ4：方程式を立てる

平均値が10になるためには：

```
(124 + □) ÷ 13 = 10
```

#### ステップ5：□を求める

両辺に13をかけます：

```
124 + □ = 10 × 13
124 + □ = 130
```

□を求めます：

```
□ = 130 - 124
□ = 6
```

#### 答え：6

---

### 検証（確かめ算）

実際に6を代入して確認してみましょう。

```python
import statistics

data = [9, 4, 8, 16, 17, 11, 6, 3, 3, 15, 3, 18, 17]
print(statistics.mean(data))
```

実行結果：
```
10.0
```

✅ 正しく平均値が10になりました！

---

### この問題で学べること

1. **mean()関数の使い方**
   - `statistics.mean()`は平均値を計算する関数
   
2. **平均値の計算原理**
   - 平均値 = 合計 ÷ 個数
   
3. **逆算の考え方**
   - 結果から逆算して未知の値を求める方法

4. **数学とプログラミングの関係**
   - プログラミングでも数学的な思考が役立つ

---

